\documentclass{book}

\usepackage{ifthen}

\newcounter{FileLines}
\newboolean{RestFile}
\newcommand{\FileLine}{}
\newread\File

\newcommand{\CountLinesInFile}[2]
{
  \setboolean{RestFile}{true}
  \setcounter{FileLines}{0}

  \openin\File=#1
  \whiledo{\boolean{RestFile}}
  {
    \ReadNextLine{\File}
    \ifthenelse{\boolean{RestFile}}{
      \stepcounter{FileLines}
    }{}
  }
  \closein\File
}

\newcommand{\ReadNextLine}[1]{
  \ifthenelse{\boolean{RestFile}}{
    \read#1 to \FileLine
    \ifeof#1\setboolean{RestFile}{false}
    \else % if last line already is read, EOF appears here
    \fi
  }{}
}

\begin{document}

\CountLinesInFile{lines.tex}

Lines in file: \arabic{FileLines}

\end{document}


